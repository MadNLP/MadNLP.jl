<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Callback wrappers · MadNLP.jl</title><meta name="title" content="Callback wrappers · MadNLP.jl"/><meta property="og:title" content="Callback wrappers · MadNLP.jl"/><meta property="twitter:title" content="Callback wrappers · MadNLP.jl"/><meta name="description" content="Documentation for MadNLP.jl."/><meta property="og:description" content="Documentation for MadNLP.jl."/><meta property="twitter:description" content="Documentation for MadNLP.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="MadNLP.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">MadNLP.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../quickstart/">Quickstart</a></li><li><a class="tocitem" href="../../options/">Options</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/multiprecision/">Multi-precision</a></li><li><a class="tocitem" href="../../tutorials/warmstart/">Warm-start</a></li><li><a class="tocitem" href="../../tutorials/lbfgs/">LBFGS</a></li><li><a class="tocitem" href="../../tutorials/kktsystem/">Custom KKT system</a></li></ul></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../../man/solver/">IPM solver</a></li><li><a class="tocitem" href="../../man/kkt/">KKT systems</a></li><li><a class="tocitem" href="../../man/linear_solvers/">Linear Solvers</a></li></ul></li><li><span class="tocitem">API Reference</span><ul><li><a class="tocitem" href="../ipm/">IPM solver</a></li><li class="is-active"><a class="tocitem" href>Callback wrappers</a></li><li><a class="tocitem" href="../kkt/">KKT systems</a></li><li><a class="tocitem" href="../linear_solvers/">Linear Solvers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Callback wrappers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Callback wrappers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/MadNLP/MadNLP.jl/blob/master/docs/src/lib/callbacks.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Callbacks"><a class="docs-heading-anchor" href="#Callbacks">Callbacks</a><a id="Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Callbacks" title="Permalink"></a></h1><p>In MadNLP, a nonlinear program is implemented with a given <code>AbstractNLPModel</code>. The model may have a form unsuitable for the interior-point algorithm. For that reason, MadNLP wraps the <code>AbstractNLPModel</code> internally using custom data structures, encoded as a <code>AbstractCallback</code>. Depending on the setting, choose to wrap the <code>AbstractNLPModel</code> as a <a href="#MadNLP.DenseCallback"><code>DenseCallback</code></a> or alternatively, as a <a href="#MadNLP.SparseCallback"><code>SparseCallback</code></a>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.AbstractCallback" href="#MadNLP.AbstractCallback"><code>MadNLP.AbstractCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractCallback{T, VT}</code></pre><p>Wrap the <code>AbstractNLPModel</code> passed by the user in a form amenable to MadNLP.</p><p>An <code>AbstractCallback</code> handles the scaling of the problem and the reformulations of the equality constraints and fixed variables.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L138-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.DenseCallback" href="#MadNLP.DenseCallback"><code>MadNLP.DenseCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DenseCallback{T, VT} &lt; AbstractCallback{T, VT}</code></pre><p>Wrap an <code>AbstractNLPModel</code> using dense structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L206-L211">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.SparseCallback" href="#MadNLP.SparseCallback"><code>MadNLP.SparseCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SparseCallback{T, VT} &lt; AbstractCallback{T, VT}</code></pre><p>Wrap an <code>AbstractNLPModel</code> using sparse structures.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L167-L172">source</a></section></article><p>The function <a href="#MadNLP.create_callback"><code>create_callback</code></a> allows to instantiate a <code>AbstractCallback</code> from a given <code>NLPModel</code>:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.create_callback" href="#MadNLP.create_callback"><code>MadNLP.create_callback</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">create_callback(
    ::Type{Callback},
    nlp::AbstractNLPModel{T, VT};
    fixed_variable_treatment=MakeParameter,
    equality_treatment=EnforceEquality,
) where {T, VT}</code></pre><p>Wrap the nonlinear program <code>nlp</code> using the callback wrapper with type <code>Callback</code>. The option <code>fixed_variable_treatment</code> decides if the fixed variables are relaxed (<code>RelaxBound</code>) or removed (<code>MakeParameter</code>). The option <code>equality_treatment</code> decides if the the equality constraints are keep as is (<code>EnforceEquality</code>) or relaxed (<code>RelaxEquality</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L149-L164">source</a></section></article><p>Internally, a <a href="#MadNLP.AbstractCallback"><code>AbstractCallback</code></a> reformulates the inequality constraints as equality constraints by introducing additional slack variables. The fixed variables are reformulated as parameters (using <a href="#MadNLP.MakeParameter"><code>MakeParameter</code></a>) or are relaxed (using <a href="#MadNLP.RelaxBound"><code>RelaxBound</code></a>). The equality constraints can be keep as is with <a href="#MadNLP.EnforceEquality"><code>EnforceEquality</code></a> (default option) or relaxed as inequality constraints with <a href="#MadNLP.RelaxEquality"><code>RelaxEquality</code></a>. In that later case, MadNLP solves a relaxation of the original problem.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.AbstractFixedVariableTreatment" href="#MadNLP.AbstractFixedVariableTreatment"><code>MadNLP.AbstractFixedVariableTreatment</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractFixedVariableTreatment</code></pre><p>Abstract type to define the reformulation of the fixed variables inside MadNLP.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.MakeParameter" href="#MadNLP.MakeParameter"><code>MadNLP.MakeParameter</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MakeParameter{VT, VI} &lt;: AbstractFixedVariableTreatment</code></pre><p>Remove the fixed variables from the optimization variables and define them as problem&#39;s parameters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L9-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.RelaxBound" href="#MadNLP.RelaxBound"><code>MadNLP.RelaxBound</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RelaxBound &lt;: AbstractFixedVariableTreatment</code></pre><p>Relax the fixed variables <span>$x = x_{fixed}$</span> as bounded variables <span>$x_{fixed} - ϵ ≤ x ≤ x_{fixed} + ϵ$</span>, with <span>$ϵ$</span> a small-enough parameter.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L22-L28">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.AbstractEqualityTreatment" href="#MadNLP.AbstractEqualityTreatment"><code>MadNLP.AbstractEqualityTreatment</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractEqualityTreatment</code></pre><p>Abstract type to define the reformulation of the equality constraints inside MadNLP.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L32-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.EnforceEquality" href="#MadNLP.EnforceEquality"><code>MadNLP.EnforceEquality</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EnforceEquality &lt;: AbstractEqualityTreatment</code></pre><p>Keep the equality constraints intact.</p><p>The solution returned by MadNLP will respect the equality constraints.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L40-L46">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.RelaxEquality" href="#MadNLP.RelaxEquality"><code>MadNLP.RelaxEquality</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RelaxEquality &lt;: AbstractEqualityTreatment</code></pre><p>Relax the equality constraints <span>$g(x) = 0$</span> with two inequality constraints, as <span>$-ϵ ≤ g(x) ≤ ϵ$</span>. The parameter <span>$ϵ$</span> is usually small.</p><p>The solution returned by MadNLP will satisfy the equality constraints only up to a tolerance <span>$ϵ$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L49-L59">source</a></section></article><p>MadNLP has to keep in memory all the indexes associated to the equality and inequality constraints. Similarly, MadNLP has to keep track of the indexes of the bounded variables and the fixed variables. MadNLP provides a utility <a href="#MadNLP.get_index_constraints"><code>get_index_constraints</code></a> to import all the indexes required by MadNLP. Each index vector is encoded as a <code>Vector{Int}</code>.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="MadNLP.get_index_constraints" href="#MadNLP.get_index_constraints"><code>MadNLP.get_index_constraints</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_index_constraints(nlp::AbstractNLPModel)</code></pre><p>Analyze the bounds of the variables and the constraints in the <code>AbstractNLPModel</code> <code>nlp</code>. Return a named-tuple witht the following keys:return (</p><ul><li><code>ind_eq</code>: indices of equality constraints.</li><li><code>ind_ineq</code>: indices of inequality constraints.</li><li><code>ind_fixed</code>: indices of fixed variables.</li><li><code>ind_lb</code>: indices of variables with a lower-bound.</li><li><code>ind_ub</code>: indices of variables with an upper-bound.</li><li><code>ind_llb</code>: indices of variables with <em>only</em> a lower-bound.</li><li><code>ind_uub</code>: indices of variables with <em>only</em> an upper-bound.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/MadNLP/MadNLP.jl/blob/a6961184eb6cc2511ed3b9970f9f470b715759a3/src/nlpmodels.jl#L63-L77">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ipm/">« IPM solver</a><a class="docs-footer-nextpage" href="../kkt/">KKT systems »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Wednesday 21 May 2025 07:07">Wednesday 21 May 2025</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
